{"version":3,"file":"code.js","sources":["../dist/bundle.es.js","src.js"],"sourcesContent":["function reduceProp(last, prop, i, props){\n    return props[i+1] !== void 0\n    ? last[prop]\n    : {last: last, prop: prop};\n}\n\nfunction formatWith(format, gets, defaults){\n\n    var ref = gets\n    .split('.')\n    .reduce(reduceProp, format);\n    var last = ref.last;\n    var prop = ref.prop;\n\n    return last[prop] !== void 0\n    ? typeof last[prop] === 'function'\n    ? last[prop]() + ''\n    : last[prop]\n    : defaults[prop] + '';\n}\n\nvar Renderer = function Renderer(string, format, defaults){\n    if ( format === void 0 ) format = {};\n    if ( defaults === void 0 ) defaults = {};\n\n    this.string = string;\n    this.format = format;\n    this.defaults = defaults;\n    this.complete = false;\n    this.pattern =  /([\\s\\S]+?)(\\\\?%)\\(([\\s\\S]+?)\\)/g;\n    this.lastIndex = 0;\n};\nRenderer.prototype.next = function next (){\n    var match = this.pattern.exec(this.string);\n    var ref = match || [];\n        var m = ref[0];\n        var pre = ref[1];\n        var leaf = ref[2];\n        var prop = ref[3];\n    if(this.complete) { return this._last(); }\n\n    if(!match){\n        this.complete = true;\n        return this._end();\n    }\n\n    this.lastIndex = this.pattern.lastIndex;\n\n    return leaf === '%'\n    ? this._every(pre, prop)\n    : this._default(m);\n};\nRenderer.prototype._last = function _last (){\n    return {done: true};\n};\nRenderer.prototype._end = function _end (){\n    return {\n        value: [\n            this.string.slice(this.lastIndex),\n            '',\n            null\n        ],\n        done: false\n    };\n};\nRenderer.prototype._default = function _default (s){\n    return {\n        value: [\n            s,\n            '',\n            null\n        ],\n        done: false\n    };\n};\nRenderer.prototype[Symbol.iterator] = function (){\n    return this;\n};\n\nvar RendererSync = (function (Renderer) {\n    function RendererSync(string, format, defaults){\n        Renderer.call(this, string, format, defaults);\n    }\n\n    if ( Renderer ) RendererSync.__proto__ = Renderer;\n    RendererSync.prototype = Object.create( Renderer && Renderer.prototype );\n    RendererSync.prototype.constructor = RendererSync;\n    RendererSync.prototype._every = function _every (pre, prop){\n        return {\n            value: [\n                pre,\n                formatWith(\n                    this.format,\n                    prop,\n                    this.defaults\n                ),\n                prop\n            ],\n            done: false\n        };\n    };\n\n    return RendererSync;\n}(Renderer));\n\nvar RendererAsync = (function (Renderer) {\n    function RendererAsync(string, format, defaults){\n        Renderer.call(this, string, format, defaults);\n    }\n\n    if ( Renderer ) RendererAsync.__proto__ = Renderer;\n    RendererAsync.prototype = Object.create( Renderer && Renderer.prototype );\n    RendererAsync.prototype.constructor = RendererAsync;\n    RendererAsync.prototype._last = function _last (){\n        return Promise.resolve(Renderer.prototype._last.call(this));\n    };\n    RendererAsync.prototype._end = function _end (){\n        return Promise.resolve(Renderer.prototype._end.call(this));\n    };\n    RendererAsync.prototype._every = function _every (pre, prop){\n        return Promise.resolve(\n            formatWith(\n                this.format,\n                prop,\n                this.defaults\n            )\n        ).then(function (result){ return ({\n            value: Promise.all([\n                pre,\n                result,\n                prop\n            ]),\n            done: false\n        }); });\n    };\n    RendererAsync.prototype._default = function _default (s){\n        return Promise.resolve(Renderer.prototype._default.call(this));\n    };\n    RendererAsync.prototype[Symbol.asyncIterator] = function (){\n      return this;\n    };\n\n    return RendererAsync;\n}(Renderer));\n\nfunction composePresenter(presentFN){\n    return function present(str, format, defaults){\n        if ( format === void 0 ) format = {};\n        if ( defaults === void 0 ) defaults = {};\n\n\n        if(typeof str !== 'string'){\n            throw new TypeError((\"The value (\" + str + \") at argument 0 is not a string\"));\n        }\n\n        if(typeof format !== 'object'){\n            throw new TypeError((\"The value (\" + format + \") at argument 1 is not an object\"));\n        }\n\n        if(typeof defaults !== 'object'){\n            throw new TypeError((\"The value (\" + defaults + \") at argument 2 is not an object\"));\n        }\n\n        return presentFN(str, format, defaults);\n    };\n}\n\nvar present = composePresenter(\n    function(str, format, defaults){\n        return new RendererSync(str, format, defaults);\n    }\n);\n\nvar asyncPresent = composePresenter(\n    function(str, format, defaults){\n        return new RendererAsync(str, format, defaults);\n    }\n);\n\nexport { present, asyncPresent };\n//# sourceMappingURL=bundle.es.js.map\n","import { present } from '../';\nconst print = console.log.bind(console);\n\nfunction render(str, obj, defaults){\n    const tpl = present(str, obj, defaults);\n\n    let results = '';\n\n    /*for(let [str, val, prop] of tpl){\n        results += str + val;\n    }*/\n\n    while(true){\n        let next = tpl.next();\n        if(next.done) break;\n        let [str, val, prop] = next.value;\n        results += str + val;\n    }\n\n    return results;\n}\n\nprint(render('Cook the %(type) pie.', {\n    type: 'peach'\n}));\n\nprint(render('Cook the %(type) pie.', {\n    type(){\n        return 'apple'\n    }\n}));\n\nprint(render('Cook the %(type) pie.'));\n\nprint(render('Cook the %(type) pie.', {}, {\n    type: 'peach'\n}));\n\nprint(render('Cook the %(pie.type) pie.', {\n    pie: {type:'cherry'}\n}));\n"],"names":["const","let","str"],"mappings":";;;AAAA,SAAS,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,CAAC;IACrC,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC;MAC1B,IAAI,CAAC,IAAI,CAAC;MACV,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;CAC9B;;AAED,SAAS,UAAU,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC;;IAEvC,IAAI,GAAG,GAAG,IAAI;KACb,KAAK,CAAC,GAAG,CAAC;KACV,MAAM,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;IAC5B,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;IACpB,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;;IAEpB,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC;MAC1B,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU;MAChC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE;MACjB,IAAI,CAAC,IAAI,CAAC;MACV,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;CACzB;;AAED,IAAI,QAAQ,GAAG,SAAS,QAAQ,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC;IACtD,KAAK,MAAM,KAAK,KAAK,CAAC,GAAG,EAAA,MAAM,GAAG,EAAE,CAAC,EAAA;IACrC,KAAK,QAAQ,KAAK,KAAK,CAAC,GAAG,EAAA,QAAQ,GAAG,EAAE,CAAC,EAAA;;IAEzC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACrB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACrB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IACzB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IACtB,IAAI,CAAC,OAAO,IAAI,iCAAiC,CAAC;IAClD,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;CACtB,CAAC;AACF,QAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,IAAI,GAAG;IACtC,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC3C,IAAI,GAAG,GAAG,KAAK,IAAI,EAAE,CAAC;QAClB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QACf,IAAI,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QACjB,IAAI,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QAClB,IAAI,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;IACtB,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE;;IAE1C,GAAG,CAAC,KAAK,CAAC;QACN,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;KACtB;;IAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;;IAExC,OAAO,IAAI,KAAK,GAAG;MACjB,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC;MACtB,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;CACtB,CAAC;AACF,QAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,SAAS,KAAK,GAAG;IACxC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;CACvB,CAAC;AACF,QAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,IAAI,GAAG;IACtC,OAAO;QACH,KAAK,EAAE;YACH,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC;YACjC,EAAE;YACF,IAAI;SACP;QACD,IAAI,EAAE,KAAK;KACd,CAAC;CACL,CAAC;AACF,QAAQ,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,QAAQ,EAAE,CAAC,CAAC;IAC/C,OAAO;QACH,KAAK,EAAE;YACH,CAAC;YACD,EAAE;YACF,IAAI;SACP;QACD,IAAI,EAAE,KAAK;KACd,CAAC;CACL,CAAC;AACF,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,WAAW;IAC7C,OAAO,IAAI,CAAC;CACf,CAAC;;AAEF,IAAI,YAAY,IAAI,UAAU,QAAQ,EAAE;IACpC,SAAS,YAAY,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC;QAC3C,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;KACjD;;IAED,KAAK,QAAQ,GAAG,EAAA,YAAY,CAAC,SAAS,GAAG,QAAQ,CAAC,EAAA;IAClD,YAAY,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,EAAE,QAAQ,IAAI,QAAQ,CAAC,SAAS,EAAE,CAAC;IACzE,YAAY,CAAC,SAAS,CAAC,WAAW,GAAG,YAAY,CAAC;IAClD,YAAY,CAAC,SAAS,CAAC,MAAM,GAAG,SAAS,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC;QACvD,OAAO;YACH,KAAK,EAAE;gBACH,GAAG;gBACH,UAAU;oBACN,IAAI,CAAC,MAAM;oBACX,IAAI;oBACJ,IAAI,CAAC,QAAQ;iBAChB;gBACD,IAAI;aACP;YACD,IAAI,EAAE,KAAK;SACd,CAAC;KACL,CAAC;;IAEF,OAAO,YAAY,CAAC;CACvB,CAAC,QAAQ,CAAC,CAAC,CAAC;;AAEb,IAAI,aAAa,IAAI,UAAU,QAAQ,EAAE;IACrC,SAAS,aAAa,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC;QAC5C,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;KACjD;;IAED,KAAK,QAAQ,GAAG,EAAA,aAAa,CAAC,SAAS,GAAG,QAAQ,CAAC,EAAA;IACnD,aAAa,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,EAAE,QAAQ,IAAI,QAAQ,CAAC,SAAS,EAAE,CAAC;IAC1E,aAAa,CAAC,SAAS,CAAC,WAAW,GAAG,aAAa,CAAC;IACpD,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,SAAS,KAAK,GAAG;QAC7C,OAAO,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAC/D,CAAC;IACF,aAAa,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,IAAI,GAAG;QAC3C,OAAO,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAC9D,CAAC;IACF,aAAa,CAAC,SAAS,CAAC,MAAM,GAAG,SAAS,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC;QACxD,OAAO,OAAO,CAAC,OAAO;YAClB,UAAU;gBACN,IAAI,CAAC,MAAM;gBACX,IAAI;gBACJ,IAAI,CAAC,QAAQ;aAChB;SACJ,CAAC,IAAI,CAAC,UAAU,MAAM,CAAC,EAAE,QAAQ;YAC9B,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC;gBACf,GAAG;gBACH,MAAM;gBACN,IAAI;aACP,CAAC;YACF,IAAI,EAAE,KAAK;SACd,EAAE,EAAE,CAAC,CAAC;KACV,CAAC;IACF,aAAa,CAAC,SAAS,CAAC,QAAQ,GAAG,SAAS,QAAQ,EAAE,CAAC,CAAC;QACpD,OAAO,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAClE,CAAC;IACF,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,WAAW;MACzD,OAAO,IAAI,CAAC;KACb,CAAC;;IAEF,OAAO,aAAa,CAAC;CACxB,CAAC,QAAQ,CAAC,CAAC,CAAC;;AAEb,SAAS,gBAAgB,CAAC,SAAS,CAAC;IAChC,OAAO,SAAS,OAAO,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,CAAC;QAC1C,KAAK,MAAM,KAAK,KAAK,CAAC,GAAG,EAAA,MAAM,GAAG,EAAE,CAAC,EAAA;QACrC,KAAK,QAAQ,KAAK,KAAK,CAAC,GAAG,EAAA,QAAQ,GAAG,EAAE,CAAC,EAAA;;;QAGzC,GAAG,OAAO,GAAG,KAAK,QAAQ,CAAC;YACvB,MAAM,IAAI,SAAS,EAAE,aAAa,GAAG,GAAG,GAAG,iCAAiC,EAAE,CAAC;SAClF;;QAED,GAAG,OAAO,MAAM,KAAK,QAAQ,CAAC;YAC1B,MAAM,IAAI,SAAS,EAAE,aAAa,GAAG,MAAM,GAAG,kCAAkC,EAAE,CAAC;SACtF;;QAED,GAAG,OAAO,QAAQ,KAAK,QAAQ,CAAC;YAC5B,MAAM,IAAI,SAAS,EAAE,aAAa,GAAG,QAAQ,GAAG,kCAAkC,EAAE,CAAC;SACxF;;QAED,OAAO,SAAS,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;KAC3C,CAAC;CACL;;AAED,IAAI,OAAO,GAAG,gBAAgB;IAC1B,SAAS,GAAG,EAAE,MAAM,EAAE,QAAQ,CAAC;QAC3B,OAAO,IAAI,YAAY,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;KAClD;CACJ,CAAC;;AC1KFA,IAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;AAExC,SAAS,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC;IAC/BA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;;IAExCC,IAAI,OAAO,GAAG,EAAE,CAAC;;;;;;IAMjB,MAAM,IAAI,CAAC;QACPA,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;QACtB,GAAG,IAAI,CAAC,IAAI,EAAE,EAAA,MAAM,EAAA;QACpB,OAAoB,GAAG,IAAI,CAAC,KAAK;QAA5B,IAAAC,KAAG;QAAE,IAAA,GAAG;QAAE,IAAA,IAAI,UAAf;QACJ,OAAO,IAAIA,KAAG,GAAG,GAAG,CAAC;KACxB;;IAED,OAAO,OAAO,CAAC;CAClB;;AAED,KAAK,CAAC,MAAM,CAAC,uBAAuB,EAAE;IAClC,IAAI,EAAE,OAAO;CAChB,CAAC,CAAC,CAAC;;AAEJ,KAAK,CAAC,MAAM,CAAC,uBAAuB,EAAE;IAClC,IAAI,eAAA,EAAE;QACF,OAAO,OAAO;KACjB;CACJ,CAAC,CAAC,CAAC;;AAEJ,KAAK,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC,CAAC;;AAEvC,KAAK,CAAC,MAAM,CAAC,uBAAuB,EAAE,EAAE,EAAE;IACtC,IAAI,EAAE,OAAO;CAChB,CAAC,CAAC,CAAC;;AAEJ,KAAK,CAAC,MAAM,CAAC,2BAA2B,EAAE;IACtC,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;CACvB,CAAC,CAAC,CAAC;;;;"}